#!/usr/bin/env bash
# mar sep  9 02:12:51 CEST 2014
# root@libcrack.so

LPORT1=tcp:27042
LPORT2=tcp:27043
TMP=/data/local/tmp
FRIDA_ANDROID_URL=http://build.frida.re/frida/android/bin/frida-server

curl -s -O "${FRIDA_ANDROID_URL}"
chmod +x frida-server
adb push frida-server "${TMP}/"

# 27042 is the port used for communicating with frida-server
# and each subsequent port is required for each of the next
# processes you inject into.

adb forward "${LPORT1}"  "${LPORT1}"
adb forward "${LPORT2}"  "${LPORT2}"

adb shell su -c "${TMP}/frida-server" -t 0

frida-ps -R

exit $?
