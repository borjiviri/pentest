#!/bin/bash
# borja@libcrack.so
# Install strace on an Android device

# set -e
set -o errexit
# set -u
set -o nounset

binzip="strace.arm32_eabi5_stripped.gz"
bin="strace"
#bindir="/system/bin"
bindir="/system/xbin"

test -e "$binzip" || exit 1;

gunzip -k -c "$binzip" > "$bin"
adb push "$bin" "/sdcard/${bin}"
adb shell su -c mount -o remount,rw /system
adb shell su -c cp "/sdcard/${bin}" "${bindir}/${bin}"
adb shell su -c chmod 0755 "${bindir}/${bin}"
adb shell su -c rm "/sdcard/${bin}"
adb shell su -c mount -o remount,ro /system
rm "$bin"

echo "${bindir}/${bin}" installed

