#!/usr/bin/env bash

set -e

host="$1"
proxy=""
cmd="$(which dirb)"
output="dirb-${host}.log"
dirb_wordlists="/usr/share/dirb/wordlists"

if [ -z "$1" ]; then echo "Usage: $0 <URL>"; exit 1; fi
if [ ! -z "$PROXY" ]; then proxy="${PROXY}"; fi

"$cmd" https://"$host" \
    "${dirb_wordlists}"/{indexes,vulns/{tomcat,iplanet,apache}}.txt \
    -p "$proxy"      \
    -o "$output"     \
    && printf "\e[32m[*]\e[0m ${cmd} finished\e[0m\n" \
    || printf "\e[31m[*]\e[0m ${cmd} failed\e[0m\n"

exit $?
