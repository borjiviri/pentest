#!/usr/bin/env bash
# libcrack.so
#Â jue ago  4 22:17:54 CEST 2016

FINDROOT="$1"

[[ ! -d $FINDROOT || -z "$FINDROOT" ]] && {
    printf "\e[31mError:\e[0m argv1: No such directory: \"$FINDROOT\"\n"
    exit 1
}

printf "[*] Finding RPATH affected binaries in \e[1m\"$FINDROOT\"\e[0m\n"

for f in $(find $FINDROOT -executable); do
    readelf -d "$f" 2>/dev/null | /bin/grep -q "PATH" && {
        rpath="$(readelf -d "$f" | grep RPATH)"
        printf "[*] Found RPATH $f: \e[0;91m${rpath}\e[0m\n"
        }
done

printf "[*] Done\n"

exit 0
